#include <ros.h>
#include <std_msgs/Int8.h>
#include <Servo.h>

#define relay_pin  A0
#define relay_pin1 A1
#define servo_pin 9

Servo servo;

ros::NodeHandle  nh;

void messageCb( const std_msgs::Int8& relay_msg){
      int val = relay_msg.data;
      if(val == 0){
        digitalWrite(relay_pin, LOW);
        }
       if(val == 1){
        digitalWrite(relay_pin,HIGH);
        }
      }
      
 void messageCb1( const std_msgs::Int8& relay_msg1){
      int val = relay_msg1.data;
      if(val == 0){
        digitalWrite(relay_pin1, LOW);
        }
       if(val == 1){
        digitalWrite(relay_pin1,HIGH);
        }
      }
      
 void messageCb2( const std_msgs::Int8& servo_msg){
      int val = servo_msg.data;
      if(val == 0){
        servo.write(0);
        }
       if(val == 1){
        servo.write(1);
        }
      }     
    


ros::Subscriber<std_msgs::Int8> sub("relay", messageCb);
ros::Subscriber<std_msgs::Int8> sub("relay1", messageCb1);
ros::Subscriber<std_msgs::Int8> sub("servo", messageCb2);

void setup()
{ 
  pinMode(relay_pin, OUTPUT);
  pinMode(relay_pin1, OUTPUT);
  digitalWrite(relay_pin, HIGH);
  digitalWrite(relay_pin1, HIGH);
  servo.attach(servo_pin);
  servo.write(0);    //initially servo to zero  angular rotation
  
  nh.initNode();
  nh.subscribe(sub);
}

void loop()
{  
  nh.spinOnce();
  delay(100);
}
